<HTML>
<BODY style = "margin: 0">
<canvas id = 'lab08' width = '100' height = '100'> </canvas>
<script>
	var canvas = document.getElementById("lab08");
	var ctx = canvas.getContext("2d");

	for (i = 10; i < 40; i++)
		ctx.fillRect (i, 30, 1, 1);
	for (i = 60; i < 80; i++)
		ctx.fillRect (i, 30, 1, 1);
	j = 30;
	for (i = 40; i < 50; i++, j++)
		ctx.fillRect (i, j, 1, 1);
	for (i = 50; i < 55; i++)
		ctx.fillRect (i, 40, 1, 1);
	for (i = 55; i < 60; i++, j--)
		ctx.fillRect (i, j, 1, 1);
	for (i = 35; i > 30; i--)
		ctx.fillRect (60, i, 1, 1);
	for (i = 30; i < 60; i++)
		ctx.fillRect (9, i, 1, 1);
	for (i = 60; i < 76; i++)
		ctx.fillRect (8, i, 1, 1);
	for (i = 9; i < 36; i++)
		ctx.fillRect (i, 76, 1, 1);
	for (i = 35; i < 47; i++)
		ctx.fillRect (i, 75, 1, 1);
	for (i = 47; i < 60; i++)
		ctx.fillRect (i, 76, 1, 1);
	for (i = 60; i < 80; i++)
		ctx.fillRect (i, 77, 1, 1);
	j = 30;
	for (i = 80; i < 90; i++, j++)
		ctx.fillRect (i, j, 1, 1);
	j = 76;
	for (i = 80; i < 90; i++, j--)
		ctx.fillRect (i, j, 1, 1);
	for (i = 40; i < 67; i++)
		ctx.fillRect (90, i, 1, 1);

	function setPixel (x,y,c) { // Функция установки пикселя в js
    		var p=ctx.createImageData(1,1);
    		p.data[0]=c.r;
    		p.data[1]=c.g;
    		p.data[2]=c.b;
    		p.data[3]=c.a;
   		ctx.putImageData(p,x,y);
	}
 
	function fill(x, y, color){ // Функция заливки многоугольника цветом color
		ctx.fillStyle = "#aa00aa";
   		var startColor = ctx.getImageData(x, y, 1,1).data;
    		var q = [[x,y]];
    		for(var i = 0; i!= q.length; i++){
        		var x = q[i][0], y = q[i][1];
        		var data = ctx.getImageData(x, y, 1,1).data;
        		if(x>=0 && y>=0 && data[0]==startColor[0] && data[1]==startColor[1] && data[2]==startColor[2] && data[3]==startColor[3]){
         			setPixel(x,y, color);
            			var s = q.length;
            			q[s] = [x+1, y];
            			q[s+1] = [x-1, y];
            			q[s+2] = [x, y+1];
        			q[s+3] = [x, y-1];
        		}
    			}
	}

	fill(50, 50, {r:200, g:100, b:200, a:255});

	var link = document.createElement("a");
	link.innerHTML = 'save image';
	link.addEventListener('click',function (event) {
		link.href = canvas.toDataURL();
		link.download = "canvas.png";
	}, false)
	document.body.appendChild(link);

</script>
</BODY>
</HTML>